# 第十一周复习参考


# Aufgabe 1: Es stinkt!


## 为什么遵守 DRY 原则对于软件的可维护性很重要？
Don’t Repeat Yourself，直译就是不要重复你自己

简单来讲，写代码的时候，如果出现雷同片段，就要想办法把他们提取出来，成为一段独立的代码。这样的抽象，可以保证任何调用这段代码的程序都能得到一致的结果；同时在需要修改时也能保证所有调用处都能获得更新。

方便修改和后期的维护

## DRY 原则不是 SRP 的另一种表述吗？

SRP意味着你的类应该只有一个责任，所以你可以很容易地给你的类命名，而且你只需阅读名字就可以知道它的作用。

DRY意味着你不应该重复自己，所以通过维护你的代码，你不需要两次或更多次地覆盖相同的代码。

它们之间肯定有联系，因为它们都是关于维护代码的。DRY是一个低抽象级别的工具，因为它对代码的作用一无所知。

SRP是一个高抽象级别的工具，因为它是关于责任而不是代码本身的。所以你应该在开发你的应用程序时同时使用这两个概念。

## 为什么函数的代码相同validate_age，validate_quantity没有违反DRY原则？
两个函数体都是一样的。代码是一样的，但它们所代表的知识是不同的。这两个函数验证了两个独立的东西，只是刚好有相同的规则。这是一个巧合，不是一个重复。

**我对这个回答存疑**

## 我们已经了解了另一种形式的气味“消息链”。在什么情况下我们已经知道它？

Message Chains : 当客户端请求另一个对象，该对象又请求另一个对象，依此类推时，就会出现消息链。这些链意味着客户端依赖于沿着类结构的导航。这些关系的任何更改都需要修改客户端。

说人话就是调用的链过长

## “内幕交易”气味违反了哪个原则？
迪米特原则（最少知识原则）：一个软件实体应当尽可能较少的与
其他实体发生相互作用

还有可能破坏了 SRP原则，因为他可能跨越本应使用的方法而直接访问另一个本不应直接访问的类。

# 在类中Collections有一个内部类SingletonMap，这个类被AbstractMap扩展了。看一下remove类的方法。你闻到什么代码味道？
代码重复

# Aufgabe 2: Namen in Programmen

如果你想不出一个好名字，那就考虑一下你选择的抽象不是一个好名字。也许您正在尝试抽象一些并不是它自己的概念的东西

## 类以大写字母开头，方法和属性以小写字母开头

## 使用公共接口，可以在 Java 中毫不犹豫地更改某些名称。这些名字是什么？

变量

# Aufgabe 3: Methoden richtig schreiben

“长方法”气味原则上违反了方法级别的 SRP。每种方法应该只有一个任务。当我们以这种方式开发方法时，理解方法就会变得容易得多。找到一个吸引人的、贴切的名字也容易得多。

### 保持较小的参数数量。

````
public int entfernung(int k1, int k2, int k3, int k4, int k5, int k6) {
    /* ... */
}

public int entfernung(Punkt p1, Punkt p2) {
    /* ... */
}
````

## 编写true一个实现分支的方法和一个实现分支的方法通常更容易false。如有必要，可以将公共部分外包给单独的方法。

````
public Paket verpacken(Produkt p, boolean geschenk) {
    if (geschenk) {
        // ...
    }
    else {
        // ...
    }
}

public Paket alsGeschenkVerpacken(Produkt p) {
        // ...
}

public Paket normalVerpacken(Produkt p) {
        // ...
}
````

## Seiteneffekte 副作用

当一个方法改变局部变量之外的状态时，他就会产生副作用，这可以是类中一个属性，文件系统中的一个文件甚至是输出流的状态

副作用是会传染的，如果我们在自己写的方法中条用另一个有副作用的方法，那么我们的方法也有副作用

没有副作用的函数即所谓的纯函数 之依赖于他们的参数，如果用相同的参数调用一个纯函数骂他也会返回相同的结果

## 单一责任原则
长方法 "的气味基本上是在方法层面上对SRP的违反。每个方法应该只有一个责任。如果我们以这种方式开发方法，理解一个方法就会变得更加容易。顺便说一句，找到一个朗朗上口、恰到好处的名字也要容易得多

记住，分解为方法主要是一种抽象的手段。这只是其次，是减少重复的一种方式。即使一段代码只出现一次，把它抽象在一个方法中可能也是有意义的

## Trennung von Kommando und Anfragen
1988 年，Bertrand Meyer 在面向对象的软件设计一书中设计了 CQS 原则。简单来说，这个原则是说程序应当要么修改系统（Command），要么返回查询结果(Query)，软件中应当保持命令与查询的分离。

CQS会使线程安全类的开发明显复杂化 。

调用一个无副作用的方法
的次数是完全没有问题
的，因为根据定义，它们
不能对系统的状态产生任
何影响。
我们可以任意地缓存一个
纯函数的结果。
纯粹的函数更容易理解。
为了分析它们，我们只需
要检查函数的代码（以及
任何被调用的函数）。但
没有必要在分析中包括任
何外部状态

# 任务 4：重构

